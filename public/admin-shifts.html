<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard Turni CREMA</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@unocss/reset/tailwind.css">
  <script src="https://cdn.tailwindcss.com"></script>
  <script type="module">
    import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';
    window.supabase = createClient(
      'https://tcfmeggqhxcnihkmnkqs.supabase.co',
      'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRjZm1lZ2dxaHhjbmloa21ua3FzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTcxOTAzMjUsImV4cCI6MjA3Mjc2NjMyNX0.VYkrvIVWti57W9UOnQcCvywmonWGyrtIT4KAzszbiFs'
    );
  </script>
  <script type="module">
    import '/js/dashboard.js';
  </script>
  <style>
    :root {
      --bg: #fffce3;
      --card: #ffffff;
      --primary: #ee7523;
      --navy: #6a3f24;
    }
    body {
      background-color: var(--bg);
    }
  </style>
</head>
<body class="font-sans text-gray-900">
  <header class="sticky top-0 z-50 bg-white border-b border-gray-200 px-4 py-2 flex items-center justify-between shadow-sm">
    <img src="https://gelatocrema.com/cdn/shop/files/logo_color.svg?v=1693061670&width=100" alt="CREMA Logo" class="h-10">
    <div class="flex gap-2">
      <button class="text-sm px-3 py-1 rounded-full bg-gray-100" onclick="location.href='/index.html'">Sito</button>
      <button class="text-sm px-3 py-1 rounded-full bg-gray-100" onclick="location.href='/employee.html'">Dipendente</button>
      <button class="text-sm px-3 py-1 rounded-full bg-orange-500 text-white" onclick="logout()">Logout</button>
    </div>
  </header>

  <main class="max-w-4xl mx-auto p-4">
    <section class="bg-white p-4 rounded shadow mb-6">
      <div class="flex items-center justify-between mb-4">
        <h2 class="text-lg font-semibold">Assegna un turno</h2>
        <button id="openEmployeeForm" class="bg-orange-600 text-white px-3 py-1 rounded text-sm">+ Nuovo Dipendente</button>
      </div>
      <form id="shiftForm" class="grid grid-cols-1 sm:grid-cols-2 gap-3">
        <input required type="date" id="shiftDate" class="border px-2 py-1 rounded" />
        <select required id="employeeName" class="border px-2 py-1 rounded"></select>
        <input required type="time" id="startTime" class="border px-2 py-1 rounded" />
        <input required type="time" id="endTime" class="border px-2 py-1 rounded" />
        <select required id="role" class="border px-2 py-1 rounded">
          <option value="">Ruolo</option>
          <option value="Addetto banco">Addetto banco</option>
          <option value="Laboratorio">Laboratorio</option>
          <option value="Manager">Manager</option>
        </select>
        <button class="bg-orange-600 text-white px-4 py-2 rounded" type="submit">Salva</button>
      </form>
    </section>

    <section class="bg-white p-4 rounded shadow mb-6">
      <h2 class="text-lg font-semibold mb-2">Turni programmati</h2>
      <div class="overflow-x-auto">
        <table class="min-w-full text-sm" id="shiftTable">
          <thead class="bg-orange-600 text-white">
            <tr>
              <th class="px-2 py-1 text-left">Data</th>
              <th class="px-2 py-1 text-left">Nome</th>
              <th class="px-2 py-1 text-left">Ruolo</th>
              <th class="px-2 py-1 text-left">Inizio</th>
              <th class="px-2 py-1 text-left">Fine</th>
              <th class="px-2 py-1 text-left">Ore (â€“0.5h)</th>
              <th class="px-2 py-1 text-left">Azioni</th>
            </tr>
          </thead>
          <tbody id="shiftBody"></tbody>
        </table>
      </div>
    </section>

    <section class="bg-white p-4 rounded shadow">
      <h2 class="text-lg font-semibold mb-2">Dipendenti registrati</h2>
      <div class="overflow-x-auto">
        <table class="min-w-full text-sm" id="employeeTable">
          <thead class="bg-gray-100">
            <tr>
              <th class="px-2 py-1 text-left">Nome</th>
              <th class="px-2 py-1 text-left">Email</th>
              <th class="px-2 py-1 text-left">Reparto</th>
              <th class="px-2 py-1 text-left">Ruolo</th>
              <th class="px-2 py-1 text-left">Azioni</th>
            </tr>
          </thead>
          <tbody id="employeeBody"></tbody>
        </table>
      </div>
    </section>

    <!-- MODAL: Nuovo Dipendente -->
    <div id="employeeModal" class="fixed inset-0 bg-black/50 flex items-center justify-center hidden">
      <div class="bg-white rounded-lg p-6 w-full max-w-md">
        <h2 class="text-xl font-semibold mb-4">Nuovo Dipendente</h2>
        <form id="newEmployeeForm" class="space-y-3">
          <input required type="text" id="newName" placeholder="Nome e Cognome" class="w-full border px-3 py-2 rounded">
          <input required type="email" id="newEmail" placeholder="Email" class="w-full border px-3 py-2 rounded">
          <select required id="newDepartment" class="w-full border px-3 py-2 rounded">
            <option value="">Reparto</option>
            <option value="Banco">Banco</option>
            <option value="Laboratorio">Laboratorio</option>
          </select>
          <input required type="text" id="newRole" placeholder="Ruolo" class="w-full border px-3 py-2 rounded">
          <div class="flex justify-end gap-2 pt-2">
            <button type="button" id="closeModal" class="px-3 py-1 border rounded">Annulla</button>
            <button type="submit" class="bg-orange-600 text-white px-4 py-1 rounded">Registra</button>
          </div>
        </form>
      </div>
    </div>
  </main>
</body>
</html>
